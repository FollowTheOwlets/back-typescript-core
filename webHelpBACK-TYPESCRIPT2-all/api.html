<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#C14424" data-link-color="#C14424"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2025-10-01T18:55:34.9249476"><title>API-контракты | Backend Typescript</title><script type="application/json" id="virtual-toc-data">[{"id":"-352721_3","level":0,"title":"Базовые принципы и глаголы HTTP","anchor":"#-352721_3"},{"id":"-352721_4","level":0,"title":"Path vs Query vs Headers: что куда?","anchor":"#-352721_4"},{"id":"-352721_5","level":0,"title":"Получение по ID","anchor":"#-352721_5"},{"id":"-352721_6","level":0,"title":"Пагинация: варианты и контракт","anchor":"#-352721_6"},{"id":"-352721_7","level":0,"title":"Батч-запросы (batch)","anchor":"#-352721_7"},{"id":"-352721_8","level":0,"title":"Когда использовать заголовки","anchor":"#-352721_8"},{"id":"-352721_9","level":0,"title":"Data-обёртка и метаданные ответа","anchor":"#-352721_9"},{"id":"-352721_10","level":0,"title":"Структура ошибок и поле _error","anchor":"#-352721_10"},{"id":"-352721_11","level":0,"title":"Какие статус-коды когда использовать","anchor":"#-352721_11"},{"id":"-352721_12","level":0,"title":"Фильтрация, сортировка, поля ответа (query-параметры)","anchor":"#-352721_12"},{"id":"-352721_13","level":0,"title":"Идемпотентность и повтор запросов","anchor":"#-352721_13"},{"id":"-352721_14","level":0,"title":"Примеры хороших и плохих путей","anchor":"#-352721_14"},{"id":"-352721_15","level":0,"title":"OpenAPI и Swagger","anchor":"#-352721_15"},{"id":"-352721_16","level":0,"title":"Практические рекомендации","anchor":"#-352721_16"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.css" rel="stylesheet"><link rel="icon" type="image/png" sizes="16x16" href="images/logo.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="API-контракты | Backend Typescript"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Backend Typescript Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation//1.0.0/api.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="API-контракты | Backend Typescript"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation//1.0.0/api.html#webpage",
    "url": "writerside-documentation//1.0.0/api.html",
    "name": "API-контракты | Backend Typescript",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "Backend Typescript Help"
}</script><!-- End Schema.org --></head><body data-id="API" data-main-title="API-контракты" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="_Backend.topic|Backend"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Backend Typescript 1.0.0 Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="API" id="API.topic">API-контракты</h1><p id="-352721_2">В этом топике разбираем, как формировать понятные и предсказуемые <span class="tooltip" id="-352721_17" title="Контракт взаимодействия между клиентом и сервером, описывающий пути, методы, форматы данных">API</span>-контракты без привязки к фреймворку. Мы пройдёмся по правилам именования <span class="tooltip" id="-352721_18" title="Конкретный путь и метод HTTP, представляющие операцию над ресурсом">endpoint</span>-ов и выбору <span class="tooltip" id="-352721_19" title="Набор глаголов (GET, POST, PUT, PATCH, DELETE), определяющих семантику операции">HTTP</span>-глаголов, разберём пагинацию, батч-запросы, получение сущностей по ID, критерии выбора <span class="tooltip" id="-352721_20" title="Параметры строки запроса для фильтрации, сортировки и пагинации">query</span> - и <span class="tooltip" id="-352721_21" title="Переменные сегменты пути, однозначно идентифицирующие ресурс">path</span>-параметров, когда использовать <span class="tooltip" id="-352721_22" title="Пара ключ:значение, влияющая на обработку запроса/ответа">заголовки</span>, как оформлять тело ответа (data-обёртки) и ошибочные ответы (поле <code class="code" id="-352721_23">_error</code>), а также какие <span class="tooltip" id="-352721_24" title="Числовой результат обработки запроса (2xx, 3xx, 4xx, 5xx)">статусы</span> возвращать в разных ситуациях. Завершим кратким введением в <span class="tooltip" id="-352721_25" title="Спецификация описания API в виде YAML/JSON документа">OpenAPI</span> и <span class="tooltip" id="-352721_26" title="Инструменты визуализации и генерации по OpenAPI (Swagger UI, Codegen)">Swagger</span>.</p><section class="chapter"><h2 id="-352721_3" data-toc="-352721_3">Базовые принципы и глаголы HTTP</h2><ul class="list _bullet" id="-352721_27"><li class="list__item" id="-352721_30"><p><span id="-352721_35"><b>Ресурсный подход (resource-oriented)</b></span>: endpoint описывает коллекцию или отдельный ресурс. Пример коллекции: <code class="code" id="-352721_36">/users</code>, элемент коллекции: <code class="code" id="-352721_37">/users/{id}</code>.</p></li><li class="list__item" id="-352721_31"><p><span id="-352721_38"><b>Глаголы определяются методом</b></span>: </p><ul class="list _bullet" id="-352721_39"><li class="list__item" id="-352721_40"><p><code class="code" id="-352721_45">GET</code> &mdash; чтение (без побочных эффектов, <span class="tooltip" id="-352721_46" title="Свойство операции давать тот же эффект при повторном выполнении.">идемпотентно</span>, безопасно).</p></li><li class="list__item" id="-352721_41"><p><code class="code" id="-352721_47">POST</code> &mdash; создание или небезопасное действие (обычно не идемпотентно).</p></li><li class="list__item" id="-352721_42"><p><code class="code" id="-352721_48">PUT</code> &mdash; полная замена ресурса (идемпотентно).</p></li><li class="list__item" id="-352721_43"><p><code class="code" id="-352721_49">PATCH</code> &mdash; частичное обновление (может быть идемпотентным по контракту).</p></li><li class="list__item" id="-352721_44"><p><code class="code" id="-352721_50">DELETE</code> &mdash; удаление ресурса (идемпотентно: повторное удаление возвращает тот же результат состояния).</p></li></ul></li><li class="list__item" id="-352721_32"><p><span id="-352721_51"><b>Именуйте пути существительными во множественном числе</b></span>: <code class="code" id="-352721_52">/orders</code>, <code class="code" id="-352721_53">/orders/{orderId}</code>, а не <code class="code" id="-352721_54">/getOrders</code> или <code class="code" id="-352721_55">/createOrder</code>.</p></li><li class="list__item" id="-352721_33"><p><span id="-352721_56"><b>Гнездите под-ресурсы</b></span>, когда есть жёстная иерархия: <code class="code" id="-352721_57">/orders/{orderId}/items</code>.</p></li><li class="list__item" id="-352721_34"><p><span id="-352721_58"><b>Версионирование</b></span>: фиксируйте мажорную версию в пути (<code class="code" id="-352721_59">/v1/...</code>) или через заголовок версии &mdash; главное, чтобы было стабильно и прозрачно.</p></li></ul><aside class="prompt" data-type="warning" data-title="" id="-352721_28"><p>Нельзя кодировать действие в пути вида <code class="code" id="-352721_60">/users/create</code> или <code class="code" id="-352721_61">/users/delete</code>. Действие задаёт метод. Исключение &mdash; доменные команды, которые не укладываются в CRUD (например, <code class="code" id="-352721_62">POST /invoices/{id}:send</code>), но и их оформляйте как действие над ресурсом через <code class="code" id="-352721_63">POST</code>.</p></aside><aside class="prompt" data-type="tip" data-title="" id="-352721_29"><p>Старайтесь, чтобы одно и то же действие всегда соответствовало одному и тому же методу. Это снижает когнитивную нагрузку для клиентов.</p></aside></section><section class="chapter"><h2 id="-352721_4" data-toc="-352721_4">Path vs Query vs Headers: что куда?</h2><ul class="list _bullet" id="-352721_64"><li class="list__item" id="-352721_66"><p><span id="-352721_69"><b>Path-параметры</b></span> &mdash; часть <code class="code" id="-352721_70">URI</code>, однозначно идентифицируют ресурс: <code class="code" id="-352721_71">/users/{id}</code>, <code class="code" id="-352721_72">/orders/{orderId}/items/{itemId}</code>.</p></li><li class="list__item" id="-352721_67"><p><span id="-352721_73"><b>Query-параметры</b></span> &mdash; фильтрация, поиск, сортировка, пагинация, не меняют идентичность ресурса: <code class="code" id="-352721_74">/users?role=admin&amp;sort=createdAt&amp;order=desc</code>.</p></li><li class="list__item" id="-352721_68"><p><span id="-352721_75"><b>Заголовки</b></span> &mdash; сквозные технические аспекты: авторизация (<code class="code" id="-352721_76">Authorization</code>), <code class="code" id="-352721_77">Idempotency-Key</code>, <code class="code" id="-352721_78">Accept</code>/<code class="code" id="-352721_79">Content-Type</code>, ключи трассировки, локаль (<code class="code" id="-352721_80">Accept-Language</code>).</p></li></ul><aside class="prompt" data-type="note" data-title="" id="-352721_65"><p>Если параметр меняет адрес конкретного ресурса &mdash; это <span id="-352721_81"><b>path</b></span>. Если параметр задаёт представление коллекции (фильтры, сортировку, страницы) &mdash; это <span id="-352721_82"><b>query</b></span>. Технические метаданные &mdash; в <span id="-352721_83"><b>headers</b></span>.</p></aside></section><section class="chapter"><h2 id="-352721_5" data-toc="-352721_5">Получение по ID</h2><p id="-352721_84">Классический шаблон: <code class="code" id="-352721_87">GET /{collection}/{id}</code>. Если ресурс не найден &mdash; возвращайте <code class="code" id="-352721_88">404</code>. Для выборки нескольких конкретных ID используйте батч (см. ниже) или <code class="code" id="-352721_89">GET /users?ids=1,2,3</code> с ограничениями на длину <code class="code" id="-352721_90">URL</code>.</p><div class="code-block" data-lang="http">
GET /users/2f7d89a1-9b3c-4f1f-86f1-6fb8d3f2c012 HTTP/1.1
Accept: application/json
        </div><div class="code-block" data-lang="json">
            {
                &quot;id&quot;: &quot;2f7d89a1-9b3c-4f1f-86f1-6fb8d3f2c012&quot;,
                &quot;email&quot;: &quot;alice@example.com&quot;,
                &quot;role&quot;: &quot;admin&quot;,
                &quot;createdAt&quot;: &quot;2025-09-20T12:34:56Z&quot;
            }
        </div></section><section class="chapter"><h2 id="-352721_6" data-toc="-352721_6">Пагинация: варианты и контракт</h2><p id="-352721_91">Есть три распространённых подхода: <span class="tooltip" id="-352721_97" title="Способ постраничной выдачи коллекций (page/size, limit/offset, cursor)">page/size</span>, <span class="tooltip" id="-352721_98" title="Способ постраничной выдачи коллекций (page/size, limit/offset, cursor)">limit/offset</span>, <span class="tooltip" id="-352721_99" title="Маркер позиции в последовательности, используемый для стабильной пагинации">cursor</span>. Выбирайте осознанно.</p><ul class="list _bullet" id="-352721_92"><li class="list__item" id="-352721_100"><p><span id="-352721_103"><b>page/size</b></span> &mdash; удобно для UI, но плохо при вставках/удалениях: элементы могут &laquo;прыгать&raquo; между страницами.</p></li><li class="list__item" id="-352721_101"><p><span id="-352721_104"><b>limit/offset</b></span> &mdash; просто реализовать, но на больших оффсетах неэффективно в БД и подвержено сдвигу данных.</p></li><li class="list__item" id="-352721_102"><p><span id="-352721_105"><b>cursor</b></span> &mdash; надёжно и эффективно для бесконечных списков: сервер возвращает <code class="code" id="-352721_106">nextCursor</code> и/или <code class="code" id="-352721_107">prevCursor</code>.</p></li></ul><aside class="prompt" data-type="tip" data-title="" id="-352721_93"><p>Для больших коллекций и лент используйте <span id="-352721_108"><b>cursor-pagination</b></span>. Для простых экранов администратора может хватить <code class="code" id="-352721_109">limit/offset</code>.</p></aside><div class="code-block" data-lang="http">
            GET /orders?limit=20&amp;cursor=eyJpZCI6IjEyMyIsImNyZWF0ZWRBdCI6IjIwMjUtMDktMjRUMTI6MDA6MDBaIn0%3D
            Accept: application/json
        </div><div class="code-block" data-lang="json">
            {
                &quot;data&quot;: [
                    {
                        &quot;id&quot;: &quot;124&quot;,
                        &quot;total&quot;: 1200,
                        &quot;createdAt&quot;: &quot;2025-09-24T12:10:00Z&quot;
                    }
                ],
                &quot;meta&quot;: {
                    &quot;limit&quot;: 20,
                    &quot;nextCursor&quot;: &quot;eyJpZCI6IjEyNCIsImNyZWF0ZWRBdCI6IjIwMjUtMDktMjRUMTI6MTA6MDBaIn0=&quot;,
                    &quot;hasMore&quot;: true
                }
            }
        </div><aside class="prompt" data-type="warning" data-title="" id="-352721_96"><p>Не смешивайте одновременно <code class="code" id="-352721_110">page/size</code> и <code class="code" id="-352721_111">cursor</code> на одном и том же endpoint &mdash; это усложняет контракт и клиентов. Выберите один способ.</p></aside></section><section class="chapter"><h2 id="-352721_7" data-toc="-352721_7">Батч-запросы (batch)</h2><p id="-352721_112">Батч уменьшает сетевые издержки и лимиты RPS, позволяя за один <code class="code" id="-352721_118">HTTP</code>-запрос обработать множество однородных операций. Два подхода:</p><ul class="list _bullet" id="-352721_113"><li class="list__item" id="-352721_119"><p><span id="-352721_121"><b>Однотипный батч</b></span>: <code class="code" id="-352721_122">POST /users:batchGet</code>, <code class="code" id="-352721_123">POST /users:batchUpdate</code>.</p></li><li class="list__item" id="-352721_120"><p><span id="-352721_124"><b>Смешанный батч</b></span>: <code class="code" id="-352721_125">POST /batch</code> с описанием разных операций (сложнее валидировать и трассировать).</p></li></ul><div class="code-block" data-lang="http">
            POST /users:batchGet HTTP/1.1
            Content-Type: application/json
        </div><div class="code-block" data-lang="json">
            {
                &quot;ids&quot;: [
                    &quot;a1&quot;,
                    &quot;a2&quot;,
                    &quot;a3&quot;
                ]
            }
        </div><div class="code-block" data-lang="json">
        {
            &quot;data&quot;: [
                {
                    &quot;id&quot;: &quot;a1&quot;,
                    &quot;email&quot;: &quot;a1@example.com&quot;
                },
                {
                    &quot;id&quot;: &quot;a2&quot;,
                    &quot;email&quot;: &quot;a2@example.com&quot;
                }
            ],
            &quot;_error&quot;: [
                {
                    &quot;id&quot;: &quot;a3&quot;,
                    &quot;code&quot;: &quot;NOT_FOUND&quot;,
                    &quot;message&quot;: &quot;User not found&quot;
                }
            ]
        }
        </div><aside class="prompt" data-type="note" data-title="" id="-352721_117"><p>В батче указывайте <span id="-352721_126"><b>частичные ошибки</b></span> на уровне элементов, чтобы не &laquo;ронять&raquo; весь запрос. Для итогового статуса подходит <code class="code" id="-352721_127">207 Multi-Status</code> или <code class="code" id="-352721_128">200 OK</code> с массивом ошибок в теле.</p></aside></section><section class="chapter"><h2 id="-352721_8" data-toc="-352721_8">Когда использовать заголовки</h2><ul class="list _bullet" id="-352721_129"><li class="list__item" id="-352721_131"><p><span id="-352721_136"><b>Аутентификация/Авторизация</b></span>: <code class="code" id="-352721_137">Authorization: Bearer ...</code>.</p></li><li class="list__item" id="-352721_132"><p><span id="-352721_138"><b>Идемпотентность</b></span>: <code class="code" id="-352721_139">Idempotency-Key</code> для безопасного повтора <code class="code" id="-352721_140">POST</code>.</p></li><li class="list__item" id="-352721_133"><p><span id="-352721_141"><b>Контент-негациация</b></span>: <code class="code" id="-352721_142">Accept</code>, <code class="code" id="-352721_143">Content-Type</code>, <code class="code" id="-352721_144">Accept-Encoding</code>.</p></li><li class="list__item" id="-352721_134"><p><span id="-352721_145"><b>Трассировка</b></span>: корреляционные ID (<code class="code" id="-352721_146">X-Request-Id</code>).</p></li><li class="list__item" id="-352721_135"><p><span id="-352721_147"><b>Локализация</b></span>: <code class="code" id="-352721_148">Accept-Language</code>.</p></li></ul><aside class="prompt" data-type="warning" data-title="" id="-352721_130"><p>Не прячьте бизнес-параметры (фильтры, поля домена) в заголовки: они должны быть в <span id="-352721_149"><b>query</b></span> или <span id="-352721_150"><b>body</b></span>. Заголовки &mdash; про транспорт и метаданные.</p></aside></section><section class="chapter"><h2 id="-352721_9" data-toc="-352721_9">Data-обёртка и метаданные ответа</h2><p id="-352721_151">Единая структура ответа облегчает жизнь клиентам. Распространённый шаблон:</p><div class="code-block" data-lang="json">
            {
                &quot;data&quot;: {
                    &quot;id&quot;: &quot;u1&quot;,
                    &quot;email&quot;: &quot;alice@example.com&quot;
                },
                &quot;meta&quot;: {
                    &quot;requestId&quot;: &quot;f0e1...&quot;,
                    &quot;traceId&quot;: &quot;9ab2...&quot;
                }
            }
        </div><ul class="list _bullet" id="-352721_153"><li class="list__item" id="-352721_155"><p><span id="-352721_157"><b>data</b></span> &mdash; полезная нагрузка (объект или массив).</p></li><li class="list__item" id="-352721_156"><p><span id="-352721_158"><b>meta</b></span> &mdash; технические метаданные: пагинация, трассировка, статистика.</p></li></ul><aside class="prompt" data-type="tip" data-title="" id="-352721_154"><p>Для списков используйте <code class="code" id="-352721_159">{ &quot;data&quot;: [ ... ], &quot;meta&quot;: { &quot;total&quot;: ..., &quot;limit&quot;: ..., &quot;cursor&quot;: ... } }</code>. Единообразие ускоряет интеграцию и тестирование.</p></aside></section><section class="chapter"><h2 id="-352721_10" data-toc="-352721_10">Структура ошибок и поле _error</h2><p id="-352721_160">Ошибки должны быть машинно-парсабельными и человекочитаемыми. Если вы приняли формат с полем <code class="code" id="-352721_164">_error</code>, делайте его единообразным:</p><div class="code-block" data-lang="json">
            {
                &quot;_error&quot;: {
                    &quot;code&quot;: &quot;VALIDATION_FAILED&quot;,
                    &quot;message&quot;: &quot;Field \&quot;email\&quot; is invalid&quot;,
                    &quot;details&quot;: [
                        {
                            &quot;field&quot;: &quot;email&quot;,
                            &quot;rule&quot;: &quot;email&quot;
                        }
                    ],
                    &quot;requestId&quot;: &quot;f0e1...&quot;
                }
            }
        </div><ul class="list _bullet" id="-352721_162"><li class="list__item" id="-352721_165"><p><span id="-352721_169"><b>code</b></span> &mdash; короткий машинный идентификатор.</p></li><li class="list__item" id="-352721_166"><p><span id="-352721_170"><b>message</b></span> &mdash; безопасное описание для пользователя/разработчика.</p></li><li class="list__item" id="-352721_167"><p><span id="-352721_171"><b>details</b></span> &mdash; массив конкретных нарушений.</p></li><li class="list__item" id="-352721_168"><p><span id="-352721_172"><b>requestId</b></span> &mdash; для поддержки и трассировки.</p></li></ul><aside class="prompt" data-type="note" data-title="" id="-352721_163"><p>Альтернатива &mdash; формат <code class="code" id="-352721_173">application/problem+json</code> (RFC 7807). Внутренние стек-трейсы и SQL-сообщения никогда не отдавайте клиенту.</p></aside></section><section class="chapter"><h2 id="-352721_11" data-toc="-352721_11">Какие статус-коды когда использовать</h2><ul class="list _bullet" id="-352721_174"><li class="list__item" id="-352721_176"><p><code class="code" id="-352721_195">200 OK</code> &mdash; успешное чтение/операция с телом ответа.</p></li><li class="list__item" id="-352721_177"><p><code class="code" id="-352721_196">201 Created</code> &mdash; создан ресурс; добавьте <code class="code" id="-352721_197">Location</code> на новый ресурс.</p></li><li class="list__item" id="-352721_178"><p><code class="code" id="-352721_198">202 Accepted</code> &mdash; операция принята асинхронно (проверьте <code class="code" id="-352721_199">status</code> по отдельному ресурсу).</p></li><li class="list__item" id="-352721_179"><p><code class="code" id="-352721_200">204 No Content</code> &mdash; успех без тела (например, <code class="code" id="-352721_201">DELETE</code>).</p></li><li class="list__item" id="-352721_180"><p><code class="code" id="-352721_202">206 Partial Content</code>/<code class="code" id="-352721_203">207 Multi-Status</code> &mdash; частичный результат (стриминг/батч).</p></li><li class="list__item" id="-352721_181"><p><code class="code" id="-352721_204">304 Not Modified</code> &mdash; при условных запросах (<code class="code" id="-352721_205">If-None-Match</code>, <code class="code" id="-352721_206">If-Modified-Since</code>).</p></li><li class="list__item" id="-352721_182"><p><code class="code" id="-352721_207">400 Bad Request</code> &mdash; ошибка запроса (валидация, синтаксис).</p></li><li class="list__item" id="-352721_183"><p><code class="code" id="-352721_208">401 Unauthorized</code> &mdash; нет/невалидная авторизация.</p></li><li class="list__item" id="-352721_184"><p><code class="code" id="-352721_209">403 Forbidden</code> &mdash; прав не хватает.</p></li><li class="list__item" id="-352721_185"><p><code class="code" id="-352721_210">404 Not Found</code> &mdash; ресурс не найден.</p></li><li class="list__item" id="-352721_186"><p><code class="code" id="-352721_211">405 Method Not Allowed</code> &mdash; метод не поддержан для ресурса.</p></li><li class="list__item" id="-352721_187"><p><code class="code" id="-352721_212">409 Conflict</code> &mdash; конфликт версий, уникальности, состояния.</p></li><li class="list__item" id="-352721_188"><p><code class="code" id="-352721_213">410 Gone</code> &mdash; ресурс удалён и не вернётся.</p></li><li class="list__item" id="-352721_189"><p><code class="code" id="-352721_214">412 Precondition Failed</code> &mdash; нарушены условия (<code class="code" id="-352721_215">If-Match</code> и т.п.).</p></li><li class="list__item" id="-352721_190"><p><code class="code" id="-352721_216">415 Unsupported Media Type</code> &mdash; неверный <code class="code" id="-352721_217">Content-Type</code>.</p></li><li class="list__item" id="-352721_191"><p><code class="code" id="-352721_218">422 Unprocessable Entity</code> &mdash; корректный JSON, но семантическая ошибка домена.</p></li><li class="list__item" id="-352721_192"><p><code class="code" id="-352721_219">429 Too Many Requests</code> &mdash; превышен лимит; добавьте <code class="code" id="-352721_220">Retry-After</code>.</p></li><li class="list__item" id="-352721_193"><p><code class="code" id="-352721_221">500 Internal Server Error</code> &mdash; внутренняя ошибка сервера.</p></li><li class="list__item" id="-352721_194"><p><code class="code" id="-352721_222">503 Service Unavailable</code> &mdash; перегрузка/техработы; добавьте <code class="code" id="-352721_223">Retry-After</code>.</p></li></ul><aside class="prompt" data-type="tip" data-title="" id="-352721_175"><p>Возвращайте максимально специфичный 4xx/5xx статус. Это ускоряет обработку ошибок на клиенте и улучшает наблюдаемость.</p></aside></section><section class="chapter"><h2 id="-352721_12" data-toc="-352721_12">Фильтрация, сортировка, поля ответа (query-параметры)</h2><p id="-352721_224">Частые параметры:</p><ul class="list _bullet" id="-352721_225"><li class="list__item" id="-352721_228"><p><code class="code" id="-352721_232">filter[&lt;field&gt;]=...</code> &mdash; фильтры (можно несколько).</p></li><li class="list__item" id="-352721_229"><p><code class="code" id="-352721_233">sort=createdAt</code> и <code class="code" id="-352721_234">order=asc|desc</code> &mdash; сортировка.</p></li><li class="list__item" id="-352721_230"><p><code class="code" id="-352721_235">fields=...</code> &mdash; проекция полей (экономит трафик).</p></li><li class="list__item" id="-352721_231"><p><code class="code" id="-352721_236">include=...</code> &mdash; инклюды связанных представлений, если нужно.</p></li></ul><div class="code-block" data-lang="http">
GET /users?filter[role]=admin&amp;fields=id,email,createdAt&amp;sort=createdAt&amp;order=desc Accept: application/json
        </div><aside class="prompt" data-type="warning" data-title="" id="-352721_227"><p>Не перегружайте один endpoint десятками нестыкующихся параметров. Когда семантика сильно отличается &mdash; выделяйте отдельный путь.</p></aside></section><section class="chapter"><h2 id="-352721_13" data-toc="-352721_13">Идемпотентность и повтор запросов</h2><p id="-352721_237">Для небезопасных операций <code class="code" id="-352721_240">POST</code> поддерживайте <code class="code" id="-352721_241">Idempotency-Key</code> в заголовке: сервер обязан обеспечить, что повтор того же ключа не создаст дубликат.</p><div class="code-block" data-lang="http">
            POST /payments HTTP/1.1
            Content-Type: application/json
            Idempotency-Key: 5b2f1b1e-b7f3-4a0a-9a9f-0f0a3c9e11aa
        </div><aside class="prompt" data-type="note" data-title="" id="-352721_239"><p>Храните результат первой обработки ключа минимум столько, сколько живёт повтор на стороне клиента (обычно 24 часа).</p></aside></section><section class="chapter"><h2 id="-352721_14" data-toc="-352721_14">Примеры хороших и плохих путей</h2><ul class="list _bullet" id="-352721_242"><li class="list__item" id="-352721_243"><p><span id="-352721_245"><b>Хорошо</b></span>: <code class="code" id="-352721_246">/v1/users</code>, <code class="code" id="-352721_247">/v1/users/{id}</code>, <code class="code" id="-352721_248">/v1/users/{id}/roles</code>.</p></li><li class="list__item" id="-352721_244"><p><span id="-352721_249"><b>Плохо</b></span>: <code class="code" id="-352721_250">/v1/getUsers</code>, <code class="code" id="-352721_251">/v1/createUser</code>, <code class="code" id="-352721_252">/v1/users/deleteById?id=...</code>.</p></li></ul></section><section class="chapter"><h2 id="-352721_15" data-toc="-352721_15">OpenAPI и Swagger</h2><p id="-352721_253"><span class="tooltip" id="-352721_256" title="Спецификация описания API в виде YAML/JSON документа">OpenAPI</span> &mdash; язык описания API (обычно YAML/JSON), позволяющий формализовать пути, параметры, схемы, ответы и ошибки. <span class="tooltip" id="-352721_257" title="Инструменты визуализации и генерации по OpenAPI (Swagger UI, Codegen)">Swagger UI</span> визуализирует и позволяет &laquo;пощёлкать&raquo; по спецификации, а <code class="code" id="-352721_258">Swagger Codegen</code>/<code class="code" id="-352721_259">OpenAPI Generator</code> &mdash; генерировать клиенты/стабы.</p><div class="code-block" data-lang="yaml">
        openapi: 3.0.3
        info:
            title: Users API
            version: 1.0.0
        servers:
            - url: https://api.example.com/v1
        paths:
            /users:
                get:
                    summary: List users
                    parameters:
                        - in: query
                          name: limit
                          schema: { type: integer, minimum: 1, maximum: 100 }
                        - in: query
                          name: cursor
                          schema: { type: string }
                    responses:
                        &quot;200&quot;:
                            description: OK
                            content:
                                application/json:
                                    schema:
                                        $ref: &quot;#/components/schemas/UserListResponse&quot;
                post:
                    summary: Create user
                    requestBody:
                        required: true
                        content:
                            application/json:
                                schema: { $ref: &quot;#/components/schemas/UserCreateRequest&quot; }
                    responses:
                        &quot;201&quot;:
                            description: Created
                            headers:
                                Location:
                                    schema: { type: string }
                            content:
                                application/json:
                                    schema:
                                        $ref: &quot;#/components/schemas/UserResponse&quot;
            /users/{id}:
                get:
                    summary: Get user by ID
                    parameters:
                        - in: path
                          name: id
                          required: true
                          schema: { type: string, format: uuid }
                    responses:
                        &quot;200&quot;:
                            description: OK
                            content:
                                application/json:
                                    schema:
                                        $ref: &quot;#/components/schemas/UserResponse&quot;
                        &quot;404&quot;:
                            description: Not found
                            content:
                                application/json:
                                    schema:
                                        $ref: &quot;#/components/schemas/ErrorResponse&quot;
        components:
            schemas:
                User:
                    type: object
                    required: [ id, email, createdAt ]
                    properties:
                        id: { type: string, format: uuid }
                        email: { type: string, format: email }
                        role: { type: string, enum: [ user, admin ] }
                        createdAt: { type: string, format: date-time }
                UserResponse:
                    type: object
                    properties:
                        data:
                            $ref: &quot;#/components/schemas/User&quot;
                        meta:
                            type: object
                            additionalProperties: true
                UserListResponse:
                    type: object
                    properties:
                        data:
                            type: array
                            items: { $ref: &quot;#/components/schemas/User&quot; }
                        meta:
                            type: object
                            properties:
                                limit: { type: integer }
                                nextCursor: { type: string, nullable: true }
                                hasMore: { type: boolean }
                UserCreateRequest:
                    type: object
                    required: [ email ]
                    properties:
                        email: { type: string, format: email }
                        role: { type: string }
                ErrorResponse:
                    type: object
                    properties:
                        _error:
                            type: object
                            required: [ code, message ]
                            properties:
                                code: { type: string }
                                message: { type: string }
                                details:
                                    type: array
                                    items:
                                        type: object
                                        properties:
                                            field: { type: string }
                                            rule: { type: string }
        </div><aside class="prompt" data-type="tip" data-title="" id="-352721_255"><p>Держите схемы (<code class="code" id="-352721_260">components/schemas</code>) как единый источник правды: клиенты и серверы могут автоматически валидировать вход/выход по этим описаниям.</p></aside></section><section class="chapter"><h2 id="-352721_16" data-toc="-352721_16">Практические рекомендации</h2><ul class="list _bullet" id="-352721_261"><li class="list__item" id="-352721_263"><p>Единый стиль путей и параметров по всему API &mdash; зафиксируйте в гайдлайне.</p></li><li class="list__item" id="-352721_264"><p>Всегда документируйте ответ с ошибкой. Клиенты должны знать структуру <code class="code" id="-352721_268">_error</code> и набор <code class="code" id="-352721_269">code</code>.</p></li><li class="list__item" id="-352721_265"><p>Добавляйте примеры (<code class="code" id="-352721_270">example</code>/<code class="code" id="-352721_271">examples</code>) в OpenAPI &mdash; это ускорит интеграцию студентов и новичков.</p></li><li class="list__item" id="-352721_266"><p>Покрывайте контракты контрактными тестами (consumer-driven, например, Pact).</p></li><li class="list__item" id="-352721_267"><p>Фиксируйте ограничения: максимальные <code class="code" id="-352721_272">limit</code>, поддерживаемые поля фильтров, сортировки, размеры батча.</p></li></ul><aside class="prompt" data-type="warning" data-title="" id="-352721_262"><p>Неразрешимые &laquo;скрытые&raquo; ломающие изменения (переименование полей, изменение типов) без версии &mdash; главный источник поломок у клиентов. Всегда выпускайте такие изменения в новой мажорной версии.</p></aside></section><div class="last-modified">26 сентября 2025</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="auth.html" class="navigation-links__prev">Авторизация и Аутентификация</a><a href="openrelemetry.html" class="navigation-links__next">Трассировки и мониторинг. Траблшутинг</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.js"></script></body></html>