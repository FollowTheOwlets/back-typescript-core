<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#C14424" data-link-color="#C14424"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2025-10-01T18:55:34.9239476"><title>Redis | Backend Typescript</title><script type="application/json" id="virtual-toc-data">[{"id":"qq0414_2","level":0,"title":"Введение","anchor":"#qq0414_2"},{"id":"qq0414_3","level":0,"title":"Когда и зачем использовать Redis","anchor":"#qq0414_3"},{"id":"qq0414_4","level":0,"title":"Базовые концепции и модели данных","anchor":"#qq0414_4"},{"id":"qq0414_5","level":0,"title":"Установка и запуск (локально)","anchor":"#qq0414_5"},{"id":"qq0414_6","level":0,"title":"Ключевые команды (быстрый справочник)","anchor":"#qq0414_6"},{"id":"qq0414_7","level":0,"title":"Java: Lettuce (рекомендуется) и Jedis (популярно)","anchor":"#qq0414_7"},{"id":"qq0414_8","level":0,"title":"Go: go-redis v9","anchor":"#qq0414_8"},{"id":"qq0414_9","level":0,"title":"TypeScript/Node.js: ioredis (или node-redis)","anchor":"#qq0414_9"},{"id":"qq0414_10","level":0,"title":"TTL, эвикции и политика памяти","anchor":"#qq0414_10"},{"id":"qq0414_11","level":0,"title":"Персистентность: RDB/AOF и производительность","anchor":"#qq0414_11"},{"id":"qq0414_12","level":0,"title":"Репликация, Sentinel и Cluster","anchor":"#qq0414_12"},{"id":"qq0414_13","level":0,"title":"Транзакции, скрипты и атомарность","anchor":"#qq0414_13"},{"id":"qq0414_14","level":0,"title":"Паттерны использования и лучшие практики","anchor":"#qq0414_14"},{"id":"qq0414_15","level":0,"title":"Примеры шаблонов задач","anchor":"#qq0414_15"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.css" rel="stylesheet"><link rel="icon" type="image/png" sizes="16x16" href="images/logo.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Redis | Backend Typescript"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Backend Typescript Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation//1.0.0/redis.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Redis | Backend Typescript"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation//1.0.0/redis.html#webpage",
    "url": "writerside-documentation//1.0.0/redis.html",
    "name": "Redis | Backend Typescript",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "Backend Typescript Help"
}</script><!-- End Schema.org --></head><body data-id="Redis" data-main-title="Redis" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="_Data.topic|Хранение данных///NoSQL.md|NO SQL"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Backend Typescript 1.0.0 Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Redis" id="Redis.topic">Redis</h1><section class="chapter"><h2 id="qq0414_2" data-toc="qq0414_2">Введение</h2><p id="qq0414_16"><span id="qq0414_19"><b>Redis</b></span> &mdash; это высокопроизводительное <span class="tooltip" id="qq0414_20" title="Хранилище данных в оперативной памяти для сверхнизких задержек">in-memory</span> хранилище ключ-значение с поддержкой богатого набора структур данных: строки, хэши, списки, множества, отсортированные множества, битовые поля, гиперлоглоги, геоданные, <span class="tooltip" id="qq0414_21" title="Структура Redis для логов событий с потребительскими группами">стримы</span> и др. Redis может работать как кэш, как брокер сообщений (через <span class="tooltip" id="qq0414_22" title="Механизм публикации/подписки сообщений без сохранения истории">Pub/Sub</span>), как быстрый индекс или как основная база для задач, где важны миллионы операций в секунду и низкие задержки.</p><ul class="list _bullet" id="qq0414_17"><li class="list__item" id="qq0414_23"><p><span id="qq0414_27"><b>Архитектура</b></span>: однопоточный цикл событий с неблокирующими I/O, атомарность отдельных команд.</p></li><li class="list__item" id="qq0414_24"><p><span id="qq0414_28"><b>Скалирование</b></span>: вертикально (CPU/ОЗУ), горизонтально через <span class="tooltip" id="qq0414_29" title="Разделение данных на части по ключам для горизонтального масштабирования">шардинг</span> &mdash; <span class="tooltip" id="qq0414_30" title="Режим Redis с автоматическим шардингом и редиректами">Redis Cluster</span>.</p></li><li class="list__item" id="qq0414_25"><p><span id="qq0414_31"><b>Отказоустойчивость</b></span>: репликация, автоматическое переключение через <span class="tooltip" id="qq0414_32" title="Компонент Redis для мониторинга, фейловера и обнаружения мастера">Sentinel</span>.</p></li><li class="list__item" id="qq0414_26"><p><span id="qq0414_33"><b>Долговечность</b></span>: снимки RDB, журнал AOF, комбинированные режимы, <span class="tooltip" id="qq0414_34" title="Механизмы долговечности данных: RDB, AOF и их комбинации">настройки персистентности</span>.</p></li></ul><aside class="prompt" data-type="tip" data-title="" id="qq0414_18"><p id="qq0414_35">Начинать проще всего с одиночного инстанса + RDB для dev и Sentinel/Cluster для продакшн-нагрузок.</p></aside></section><section class="chapter"><h2 id="qq0414_3" data-toc="qq0414_3">Когда и зачем использовать Redis</h2><ul class="list _bullet" id="qq0414_36"><li class="list__item" id="qq0414_38"><p><span id="qq0414_44"><b>Кэш перед БД</b></span>: снижает нагрузку на основную СУБД, ускоряет ответы.</p></li><li class="list__item" id="qq0414_39"><p><span id="qq0414_45"><b>Сессии и токены</b></span>: хранение короткоживущих данных с TTL.</p></li><li class="list__item" id="qq0414_40"><p><span id="qq0414_46"><b>Очереди и события</b></span>: через <code class="code" id="qq0414_47">LPUSH</code>/<code class="code" id="qq0414_48">BRPOP</code>, <span class="tooltip" id="qq0414_49" title="Структура Redis для логов событий с потребительскими группами">Streams</span> и <span class="tooltip" id="qq0414_50" title="Механизм публикации/подписки сообщений без сохранения истории">Pub/Sub</span>.</p></li><li class="list__item" id="qq0414_41"><p><span id="qq0414_51"><b>Рейтинг/лидерборды</b></span>: <code class="code" id="qq0414_52">ZADD/ZRANGE</code> по скору.</p></li><li class="list__item" id="qq0414_42"><p><span id="qq0414_53"><b>Счётчики и квоты</b></span>: атомарные <code class="code" id="qq0414_54">INCR</code>, <code class="code" id="qq0414_55">INCRBY</code>, скользящие окна.</p></li><li class="list__item" id="qq0414_43"><p><span id="qq0414_56"><b>Geo-поиск</b></span>: <code class="code" id="qq0414_57">GEOADD</code>, <code class="code" id="qq0414_58">GEORADIUS</code>.</p></li></ul><aside class="prompt" data-type="warning" data-title="" id="qq0414_37"><p id="qq0414_59">Redis &mdash; не реляционная БД: нет join, транзакции ограничены набором ключей и <span class="tooltip" id="qq0414_60" title="Механизм транзакций в Redis: пакет команд выполняется атомарно">MULTI/EXEC</span>. Для критичных к консистентности бизнес-транзакций используйте профильные СУБД.</p></aside></section><section class="chapter"><h2 id="qq0414_4" data-toc="qq0414_4">Базовые концепции и модели данных</h2><ul class="list _bullet" id="qq0414_61"><li class="list__item" id="qq0414_63"><p><span id="qq0414_71"><b>Ключи</b></span>: бинарно-безопасные строки, рекомендуются префиксы (<code class="code" id="qq0414_72">app:users:123</code>).</p></li><li class="list__item" id="qq0414_64"><p><span id="qq0414_73"><b>Строки</b></span>: до 512 МБ; поддержка битовых операций и инкрементов.</p></li><li class="list__item" id="qq0414_65"><p><span id="qq0414_74"><b>Хэши</b></span>: компактное хранение полей объекта (<code class="code" id="qq0414_75">HSET/HGETALL</code>).</p></li><li class="list__item" id="qq0414_66"><p><span id="qq0414_76"><b>Списки</b></span>: двусторонние очереди (<code class="code" id="qq0414_77">LPUSH/RPUSH/BLPOP</code>).</p></li><li class="list__item" id="qq0414_67"><p><span id="qq0414_78"><b>Множества</b></span>: уникальные элементы, операции теории множеств (<code class="code" id="qq0414_79">SADD/SMEMBERS</code>).</p></li><li class="list__item" id="qq0414_68"><p><span id="qq0414_80"><b>Отсортированные множества</b></span>: элементы с числовым скором для ранжирования (<code class="code" id="qq0414_81">ZADD/ZREVRANGE</code>).</p></li><li class="list__item" id="qq0414_69"><p><span id="qq0414_82"><b>Streams</b></span>: лог записей с идентификаторами; потребительские группы.</p></li><li class="list__item" id="qq0414_70"><p><span id="qq0414_83"><b>TTL</b></span>: истечение ключей (<code class="code" id="qq0414_84">EXPIRE/PEXPIRE</code>), пассивное и активное удаление.</p></li></ul><aside class="prompt" data-type="note" data-title="" id="qq0414_62"><p id="qq0414_85">Выбор структуры данных влияет на сложность операций: <code class="code" id="qq0414_86">ZRANGE</code> и <code class="code" id="qq0414_87">HGETALL</code> имеют разные характеристики. Проектируйте ключи и структуры до начала разработки.</p></aside></section><section class="chapter"><h2 id="qq0414_5" data-toc="qq0414_5">Установка и запуск (локально)</h2><div class="code-block" data-lang="bash">
# Mac (Homebrew)
brew install redis
brew services start redis

# Debian/Ubuntu

sudo apt-get update
sudo apt-get install -y redis
sudo systemctl enable --now redis

# Docker

docker run -p 6379:6379 --name redis redis:7-alpine </div><aside class="prompt" data-type="tip" data-title="" id="qq0414_89"><p id="qq0414_90">Для продакшна включите аутентификацию (<code class="code" id="qq0414_91">requirepass</code>), настройте <code class="code" id="qq0414_92">maxmemory</code> и политику удаления (<span class="tooltip" id="qq0414_93" title="Политика удаления ключей при нехватке памяти (LRU/LFU/TTL и др.)">eviction</span>), включите персистентность.</p></aside></section><section class="chapter"><h2 id="qq0414_6" data-toc="qq0414_6">Ключевые команды (быстрый справочник)</h2><ul class="list _bullet" id="qq0414_94"><li class="list__item" id="qq0414_95"><p><span id="qq0414_104"><b>Строки</b></span>: <code class="code" id="qq0414_105">SET key val EX 60</code>, <code class="code" id="qq0414_106">GET key</code>, <code class="code" id="qq0414_107">INCR cnt</code></p></li><li class="list__item" id="qq0414_96"><p><span id="qq0414_108"><b>Хэши</b></span>: <code class="code" id="qq0414_109">HSET user:1 name &quot;Ann&quot; age 30</code>, <code class="code" id="qq0414_110">HGETALL user:1</code></p></li><li class="list__item" id="qq0414_97"><p><span id="qq0414_111"><b>Списки</b></span>: <code class="code" id="qq0414_112">LPUSH q task1</code>, <code class="code" id="qq0414_113">BRPOP q 0</code></p></li><li class="list__item" id="qq0414_98"><p><span id="qq0414_114"><b>Множества</b></span>: <code class="code" id="qq0414_115">SADD tags red blue</code>, <code class="code" id="qq0414_116">SINTER a b</code></p></li><li class="list__item" id="qq0414_99"><p><span id="qq0414_117"><b>Отсортированные множества</b></span>: <code class="code" id="qq0414_118">ZADD board 100 user1</code>, <code class="code" id="qq0414_119">ZREVRANGE board 0 9 WITHSCORES</code></p></li><li class="list__item" id="qq0414_100"><p><span id="qq0414_120"><b>Streams</b></span>: <code class="code" id="qq0414_121">XADD mystream * field1 val1</code>, <code class="code" id="qq0414_122">XREAD COUNT 10 STREAMS mystream 0-0</code></p></li><li class="list__item" id="qq0414_101"><p><span id="qq0414_123"><b>Ключи и TTL</b></span>: <code class="code" id="qq0414_124">EXPIRE key 60</code>, <code class="code" id="qq0414_125">TTL key</code>, <code class="code" id="qq0414_126">DEL key</code></p></li><li class="list__item" id="qq0414_102"><p><span id="qq0414_127"><b>Транзакции</b></span>: <code class="code" id="qq0414_128">MULTI</code>... <code class="code" id="qq0414_129">EXEC</code>, <code class="code" id="qq0414_130">WATCH</code></p></li><li class="list__item" id="qq0414_103"><p><span id="qq0414_131"><b>Скрипты</b></span>: <code class="code" id="qq0414_132">EVAL</code>, <code class="code" id="qq0414_133">EVALSHA</code></p></li></ul></section><section class="chapter"><h2 id="qq0414_7" data-toc="qq0414_7">Java: Lettuce (рекомендуется) и Jedis (популярно)</h2><p id="qq0414_134">Пример на <span id="qq0414_138"><b>Lettuce</b></span> (асинхронный/реактивный клиент). Покажем базовые операции, транзакции, Pub/Sub.</p><div class="code-block" data-lang="markup">

                &lt;dependency&gt;
  &lt;groupId&gt;io.lettuce&lt;/groupId&gt;
  &lt;artifactId&gt;lettuce-core&lt;/artifactId&gt;
  &lt;version&gt;6.3.1.RELEASE&lt;/version&gt;
&lt;/dependency&gt;
    </div><div class="code-block" data-lang="java">
import io.lettuce.core.RedisClient;
import io.lettuce.core.RedisURI;
import io.lettuce.core.api.StatefulRedisConnection;
import io.lettuce.core.api.sync.RedisCommands;
import io.lettuce.core.api.async.RedisAsyncCommands;
import io.lettuce.core.pubsub.StatefulRedisPubSubConnection;

public class RedisLettuceExample {
public static void main(String[] args) throws Exception {
RedisURI uri = RedisURI.Builder.redis(&quot;localhost&quot;, 6379)
//.withPassword(&quot;secret&quot;.toCharArray())
.build();
RedisClient client = RedisClient.create(uri);


// Синхронные команды
try (StatefulRedisConnection&lt;String, String&gt; conn = client.connect()) {
  RedisCommands&lt;String, String&gt; cmd = conn.sync();
  cmd.setex(&quot;app:sess:123&quot;, 60, &quot;user=42&quot;);
  String v = cmd.get(&quot;app:sess:123&quot;);
  System.out.println(&quot;GET: &quot; + v); // демонстрация

  // Транзакция
  cmd.multi();
  cmd.incr(&quot;counter&quot;);
  cmd.incrby(&quot;counter&quot;, 5);
  cmd.exec();
  System.out.println(&quot;Counter=&quot; + cmd.get(&quot;counter&quot;));
}

client.shutdown();


}
} </div><aside class="prompt" data-type="tip" data-title="" id="qq0414_137"><p id="qq0414_139">Для высокой пропускной способности используйте пайплайнинг (в Lettuce &mdash; async API) и соединения-пулы.</p></aside></section><section class="chapter"><h2 id="qq0414_8" data-toc="qq0414_8">Go: go-redis v9</h2><p id="qq0414_140">Go-клиент <span id="qq0414_144"><b>redis/go-redis</b></span> поддерживает кластеры, Sentinel, контекст, пайплайнинг и транзакции.</p><div class="code-block" data-lang="bash">
go get github.com/redis/go-redis/v9
    </div><div class="code-block" data-lang="go">
package main

import (
&quot;context&quot;
&quot;fmt&quot;
&quot;time&quot;

&quot;github.com/redis/go-redis/v9&quot;
)

var ctx = context.Background()

func main() {
    rdb := redis.NewClient(&amp;redis.Options{
        Addr: &quot;localhost:6379&quot;,
        // Password: &quot;secret&quot;,
        DB: 0,
    })
    defer rdb.Close()

    // SET/GET + TTL
    if err := rdb.Set(ctx, &quot;app:sess:123&quot;, &quot;user=42&quot;, 60*time.Second).Err(); err != nil {
        panic(err)
    }
    v, _ := rdb.Get(ctx, &quot;app:sess:123&quot;).Result()
    fmt.Println(&quot;GET:&quot;, v) // демонстрация
} </div><aside class="prompt" data-type="note" data-title="" id="qq0414_143"><p id="qq0414_145">Для кластера используйте <code class="code" id="qq0414_146">redis.NewClusterClient</code>, для Sentinel &mdash; <code class="code" id="qq0414_147">redis.NewFailoverClient</code>. Старайтесь передавать в контексте таймауты.</p></aside></section><section class="chapter"><h2 id="qq0414_9" data-toc="qq0414_9">TypeScript/Node.js: ioredis (или node-redis)</h2><p id="qq0414_148"><span id="qq0414_152"><b>ioredis</b></span> стабилен, поддерживает кластер, Sentinel, пайплайны и скрипты. Ниже &mdash; базовые операции, Pub/Sub, Lua.</p><div class="code-block" data-lang="bash">
                npm i ioredis
            </div><div class="code-block" data-lang="ts">
                    import Redis from &quot;ioredis&quot;;
                    
                    async function main() {
                        const redis = new Redis({
                            host: &quot;127.0.0.1&quot;,
                            port: 6379,
                            // password: &quot;secret&quot;,
                            // lazyConnect: true,
                        });
                    
                        // SET с TTL, GET
                        await redis.set(&quot;app:sess:123&quot;, &quot;user=42&quot;, &quot;EX&quot;, 60);
                        const val = await redis.get(&quot;app:sess:123&quot;);
                        console.log(&quot;GET&quot;, val); // демонстрация
                    
                        await redis.quit();
                    }
                    
                    main().catch(console.error); 
                </div><aside class="prompt" data-type="warning" data-title="" id="qq0414_151"><p id="qq0414_153">Не храните большие бинарные блобы напрямую в Redis: это быстро &laquo;съест&raquo; память и приведёт к эвикциям. Для крупных объектов используйте внешнее хранилище (например, S3/MinIO), а в Redis &mdash; только индексы/метаданные.</p></aside></section><section class="chapter"><h2 id="qq0414_10" data-toc="qq0414_10">TTL, эвикции и политика памяти</h2><p id="qq0414_154">Память в Redis конечна (<code class="code" id="qq0414_157">maxmemory</code>). При переполнении включается <span class="tooltip" id="qq0414_158" title="Политика удаления ключей при нехватке памяти (LRU/LFU/TTL и др.)">политика удаления</span>: <code class="code" id="qq0414_159">noeviction</code>, <code class="code" id="qq0414_160">allkeys-lru</code>, <code class="code" id="qq0414_161">allkeys-lfu</code>, <code class="code" id="qq0414_162">volatile-lru</code>, <code class="code" id="qq0414_163">volatile-ttl</code> и др. Ключи с TTL могут удаляться проактивно (active expire) и при обращении (lazy expire).</p><aside class="prompt" data-type="tip" data-title="" id="qq0414_155"><p id="qq0414_164">Для кэшей стремитесь к <code class="code" id="qq0414_165">allkeys-lfu</code> или <code class="code" id="qq0414_166">allkeys-lru</code>. Обязательно задавайте TTL для кэш-ключей, чтобы избежать устаревших данных.</p></aside><aside class="prompt" data-type="warning" data-title="" id="qq0414_156"><p id="qq0414_167">Политика <code class="code" id="qq0414_168">noeviction</code> приведёт к ошибкам записи при нехватке памяти. Для интерактивных систем это может проявляться как случайные падения при пиках.</p></aside></section><section class="chapter"><h2 id="qq0414_11" data-toc="qq0414_11">Персистентность: RDB/AOF и производительность</h2><ul class="list _bullet" id="qq0414_169"><li class="list__item" id="qq0414_171"><p><span id="qq0414_174"><b>RDB</b></span>: периодические снимки (быстрый рестарт, меньше размер, риск потери последних секунд/минут).</p></li><li class="list__item" id="qq0414_172"><p><span id="qq0414_175"><b>AOF</b></span>: журнал всех операций (минимальная потеря, больше размер, периодическая компрессия <code class="code" id="qq0414_176">BGREWRITEAOF</code>).</p></li><li class="list__item" id="qq0414_173"><p><span id="qq0414_177"><b>Смешанный режим</b></span>: оптимальный баланс старта, размера и надёжности.</p></li></ul><aside class="prompt" data-type="note" data-title="" id="qq0414_170"><p id="qq0414_178">Для продакшна обычно включают AOF (<code class="code" id="qq0414_179">appendonly yes</code>, режим <code class="code" id="qq0414_180">everysec</code>) + регулярные RDB-снимки для быстрого восстановления.</p></aside></section><section class="chapter"><h2 id="qq0414_12" data-toc="qq0414_12">Репликация, Sentinel и Cluster</h2><ul class="list _bullet" id="qq0414_181"><li class="list__item" id="qq0414_183"><p><span id="qq0414_186"><b>Репликация</b></span>: <code class="code" id="qq0414_187">replicaof host port</code>, чтение с реплик (beware eventual consistency).</p></li><li class="list__item" id="qq0414_184"><p><span id="qq0414_188"><b>Sentinel</b></span>: мониторинг мастера, автоматическое переключение на реплику, выдача адреса мастера клиентам.</p></li><li class="list__item" id="qq0414_185"><p><span id="qq0414_189"><b>Cluster</b></span>: горизонтальное масштабирование, 16384 хэш-слотов, редиректы <code class="code" id="qq0414_190">MOVED</code>/<code class="code" id="qq0414_191">ASK</code>, шардирование по ключам.</p></li></ul><aside class="prompt" data-type="warning" data-title="" id="qq0414_182"><p id="qq0414_192">В кластере избегайте операций над несколькими ключами с разными хэш-тегами. Используйте <code class="code" id="qq0414_193">{tag}</code> в ключе для принудительного ко-локирования (например, <code class="code" id="qq0414_194">cart:{userId}:items</code> и <code class="code" id="qq0414_195">cart:{userId}:meta</code>).</p></aside></section><section class="chapter"><h2 id="qq0414_13" data-toc="qq0414_13">Транзакции, скрипты и атомарность</h2><p id="qq0414_196">Команды Redis атомарны; батчи через <code class="code" id="qq0414_199">MULTI/EXEC</code> исполняются последовательно. Для условных апдейтов используйте <code class="code" id="qq0414_200">WATCH</code> (оптимистическая блокировка). Сложную бизнес-логику можно перенести в Lua-скрипты (<code class="code" id="qq0414_201">EVAL</code>), чтобы выполнить серию операций атомарно на сервере.</p><div class="code-block" data-lang="none">
            # Пример с WATCH
            WATCH user:42:balance
            val = GET user:42:balance
            # если достаточно средств -&gt; MULTI ... DECRBY ... EXEC
             </div><aside class="prompt" data-type="tip" data-title="" id="qq0414_198"><p id="qq0414_202">Lua-скрипты кэшируйте через <code class="code" id="qq0414_203">SCRIPT LOAD</code> + <code class="code" id="qq0414_204">EVALSHA</code> и ограничивайте по времени, чтобы не блокировать event-loop.</p></aside></section><section class="chapter"><h2 id="qq0414_14" data-toc="qq0414_14">Паттерны использования и лучшие практики</h2><ul class="list _bullet" id="qq0414_205"><li class="list__item" id="qq0414_207"><p><span id="qq0414_212"><b>Именование ключей</b></span>: префиксы по доменам (<code class="code" id="qq0414_213">app:module:entity:id</code>), единый регистр, документируйте схемы.</p></li><li class="list__item" id="qq0414_208"><p><span id="qq0414_214"><b>Кэш-стратегии</b></span>: cache-aside (сперва БД &rarr; кэш), write-through, write-behind; выбирайте с учётом консистентности/нагрузки.</p></li><li class="list__item" id="qq0414_209"><p><span id="qq0414_215"><b>Избегайте горячих ключей</b></span>: распределяйте нагрузку (<code class="code" id="qq0414_216">shardId</code> в ключе), используйте батчи/пайплайны.</p></li><li class="list__item" id="qq0414_210"><p><span id="qq0414_217"><b>Обсервабилити</b></span>: <code class="code" id="qq0414_218">INFO</code>, <code class="code" id="qq0414_219">MONITOR</code>, экспортеры Prometheus, трейсинг клиентов.</p></li><li class="list__item" id="qq0414_211"><p><span id="qq0414_220"><b>Безопасность</b></span>: аутентификация, ACL, защищённая сеть, TLS, firewall; не выставляйте Redis в интернет.</p></li></ul><aside class="prompt" data-type="warning" data-title="" id="qq0414_206"><p id="qq0414_221">Команда <code class="code" id="qq0414_222">KEYS *</code> в продакшне опасна &mdash; блокирует сервер. Для сканирования используйте <code class="code" id="qq0414_223">SCAN</code> итеративно.</p></aside></section><section class="chapter"><h2 id="qq0414_15" data-toc="qq0414_15">Примеры шаблонов задач</h2><ul class="list _bullet" id="qq0414_224"><li class="list__item" id="qq0414_225"><p><span id="qq0414_229"><b>Rate limiting</b></span>: счётчики с TTL или Lua со скользящим окном.</p></li><li class="list__item" id="qq0414_226"><p><span id="qq0414_230"><b>Лидерборды</b></span>: <code class="code" id="qq0414_231">ZADD</code> + <code class="code" id="qq0414_232">ZRANGE</code>/<code class="code" id="qq0414_233">ZREVRANGE</code> по очкам.</p></li><li class="list__item" id="qq0414_227"><p><span id="qq0414_234"><b>Очереди</b></span>: списки с <code class="code" id="qq0414_235">BRPOPLPUSH</code> для &laquo;надёжного&raquo; потребления или Streams с группами.</p></li><li class="list__item" id="qq0414_228"><p><span id="qq0414_236"><b>Сеансы</b></span>: <code class="code" id="qq0414_237">SETEX</code> и ротация ключей, вторичная индексация по пользователю (множества/хэши).</p></li></ul></section><div class="last-modified">01 октября 2025</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="nosql.html" class="navigation-links__prev">NO SQL</a><a href="indexes.html" class="navigation-links__next">Индексы</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.js"></script></body></html>