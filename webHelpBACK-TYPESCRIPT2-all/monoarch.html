<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#C14424" data-link-color="#C14424"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2025-10-01T18:55:35.1001433"><title>Монолитная архитектура | Backend Typescript</title><script type="application/json" id="virtual-toc-data">[{"id":"bfcoha_2","level":0,"title":"Что такое монолит","anchor":"#bfcoha_2"},{"id":"bfcoha_3","level":0,"title":"Сильные стороны","anchor":"#bfcoha_3"},{"id":"bfcoha_4","level":0,"title":"Слабые стороны","anchor":"#bfcoha_4"},{"id":"bfcoha_5","level":0,"title":"Основные подходы к проектированию монолита","anchor":"#bfcoha_5"},{"id":"bfcoha_6","level":0,"title":"Ключевые архитектурные решения в монолите","anchor":"#bfcoha_6"},{"id":"bfcoha_7","level":0,"title":"Использование КОП для разбиения разработки на команды","anchor":"#bfcoha_7"},{"id":"bfcoha_8","level":0,"title":"Практики для монолита в продакшне","anchor":"#bfcoha_8"},{"id":"bfcoha_9","level":0,"title":"Типичные анти-паттерны и как их избегать","anchor":"#bfcoha_9"},{"id":"bfcoha_10","level":0,"title":"Масштабирование и эволюция монолита","anchor":"#bfcoha_10"},{"id":"bfcoha_11","level":0,"title":"Мини-шаблоны структуры репозитория (пример)","anchor":"#bfcoha_11"},{"id":"bfcoha_12","level":0,"title":"Пример инварианта на уровне БД","anchor":"#bfcoha_12"},{"id":"bfcoha_13","level":0,"title":"Чек-лист готовности","anchor":"#bfcoha_13"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.css" rel="stylesheet"><link rel="icon" type="image/png" sizes="16x16" href="images/logo.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Монолитная архитектура | Backend Typescript"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Backend Typescript Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation//1.0.0/monoarch.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Монолитная архитектура | Backend Typescript"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation//1.0.0/monoarch.html#webpage",
    "url": "writerside-documentation//1.0.0/monoarch.html",
    "name": "Монолитная архитектура | Backend Typescript",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "Backend Typescript Help"
}</script><!-- End Schema.org --></head><body data-id="MonoArch" data-main-title="Монолитная архитектура" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="_Theory.topic|Теория///_Arch.topic|Архитектура"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Backend Typescript 1.0.0 Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="MonoArch" id="MonoArch.topic">Монолитная архитектура</h1><section class="chapter"><h2 id="bfcoha_2" data-toc="bfcoha_2">Что такое монолит</h2><p id="bfcoha_14"><span id="bfcoha_16"><b>Монолитное приложение</b></span> &mdash; это единый развёртываемый артефакт (один процесс, одна кодовая база и, как правило, один пакет поставки), в котором все подсистемы (интерфейс, доменная логика, интеграции, доступ к данным) размещены вместе. Монолит может быть примитивным &laquo;всё-под-одной-крышей&raquo; или дисциплинированным <span class="tooltip" id="bfcoha_17" title="Монолит, организованный как набор изолированных модулей с публичными контрактами и скрытыми внутренностями">модульным монолитом</span> с чёткими границами модулей.</p><aside class="prompt" data-type="note" data-title="" id="bfcoha_15"><p>Монолит &mdash; это не &laquo;антимикросервисы&raquo;. Это архитектурная форма с собственными сильными и слабыми сторонами и сценариями уместности.</p></aside></section><section class="chapter"><h2 id="bfcoha_3" data-toc="bfcoha_3">Сильные стороны</h2><ul class="list _bullet" id="bfcoha_18"><li class="list__item" id="bfcoha_19"><p><span id="bfcoha_23"><b>Простота разработки и отладки.</b></span> Одна кодовая база, единый рантайм и стек. Локальный запуск полностью имитирует продакшн-контекст.</p></li><li class="list__item" id="bfcoha_20"><p><span id="bfcoha_24"><b>Согласованность данных по умолчанию.</b></span> Границы <span class="tooltip" id="bfcoha_25" title="Атомарная последовательность операций над данными (ACID), завершающаяся полностью или откатывающаяся">транзакций</span> легко провести в рамках одной БД, проще реализовать инварианты.</p></li><li class="list__item" id="bfcoha_21"><p><span id="bfcoha_26"><b>Простая поставка.</b></span> Один артефакт &mdash; меньше движущихся частей в CI/CD, стандартные стратегии релизов (blue/green, canary) применяются тривиально.</p></li><li class="list__item" id="bfcoha_22"><p><span id="bfcoha_27"><b>Более низкие накладные расходы.</b></span> Нет межсервисной сетевой латентности и сериализации &mdash; меньше расходов на инфраструктуру и эксплуатацию.</p></li></ul></section><section class="chapter"><h2 id="bfcoha_4" data-toc="bfcoha_4">Слабые стороны</h2><ul class="list _bullet" id="bfcoha_28"><li class="list__item" id="bfcoha_30"><p><span id="bfcoha_34"><b>Риск эрозии границ.</b></span> При слабой дисциплине модули &laquo;протекают&raquo;, образуя <span class="tooltip" id="bfcoha_35" title="Антипаттерн: бесструктурная кодовая база без чётких границ и принципов">&laquo;большой ком грязи&raquo;</span>.</p></li><li class="list__item" id="bfcoha_31"><p><span id="bfcoha_36"><b>Масштабирование целиком.</b></span> Горизонтальное масштабирование зачастую вынуждено тащить весь код, даже если горячая только малая часть.</p></li><li class="list__item" id="bfcoha_32"><p><span id="bfcoha_37"><b>Замедление сборки и тестов.</b></span> Рост кодовой базы увеличивает время сборки, запуска тестов и обратной связи.</p></li><li class="list__item" id="bfcoha_33"><p><span id="bfcoha_38"><b>Сложности параллельной работы больших команд.</b></span> Высокие риски конфликтов при мерджах и каскадных изменений.</p></li></ul><aside class="prompt" data-type="warning" data-title="" id="bfcoha_29"><p>Слабые границы модулей приводят к хрупким зависимостям и &laquo;сквозным&raquo; изменениям. Это основной источник техдолга в монолитах.</p></aside></section><section class="chapter"><h2 id="bfcoha_5" data-toc="bfcoha_5">Основные подходы к проектированию монолита</h2><section class="chapter"><h3 id="bfcoha_39" data-toc="bfcoha_39">Слоистая архитектура (Layered)</h3><p id="bfcoha_43">Классическая стратификация: <code class="code" id="bfcoha_46">Presentation</code> &rarr; <code class="code" id="bfcoha_47">Application</code> &rarr; <code class="code" id="bfcoha_48">Domain</code> &rarr; <code class="code" id="bfcoha_49">Infrastructure</code>. Слои формируют &laquo;вертикальные правила зависимости&raquo;: верхние зависят от нижних, но не наоборот.</p><aside class="prompt" data-type="tip" data-title="" id="bfcoha_44"><p>Фиксируйте зависимость &laquo;вверх-вниз&raquo; линтерами и правилом импорта: слой не может импортировать код из слоя над собой.</p></aside><aside class="prompt" data-type="warning" data-title="" id="bfcoha_45"><p>Частая ошибка &mdash; бизнес-правила в инфраструктуре (валидация, агрегаты в ORM-энтитях). Это размывает модель.</p></aside></section><section class="chapter"><h3 id="bfcoha_40" data-toc="bfcoha_40">Модульный монолит (Modular Monolith)</h3><p id="bfcoha_50">Монолит разделён на изолированные <span class="tooltip" id="bfcoha_52" title="Изолированный фрагмент кода, который можно импортировать и экспортировать">модули</span> с публичными <span class="tooltip" id="bfcoha_53" title="Формальное описание предоставляемых и требуемых интерфейсов компонента, включая типы и инварианты">контрактами</span>. Внутренности модулей закрыты, межмодульная коммуникация идёт через фасады, команды/запросы или доменные события (в памяти).</p><aside class="prompt" data-type="note" data-title="" id="bfcoha_51"><p>Модульный монолит &mdash; отличная ступень перед микросервисами: границы и контракты уже есть, останется вынести процессы в отдельные сервисы.</p></aside></section><section class="chapter"><h3 id="bfcoha_41" data-toc="bfcoha_41">Вертикальные срезы (Feature Slices)</h3><p id="bfcoha_54">Структурирование по фичам/поддоменам: каждая фича содержит свой <code class="code" id="bfcoha_56">ui</code>, <code class="code" id="bfcoha_57">application</code>, <code class="code" id="bfcoha_58">domain</code>, <code class="code" id="bfcoha_59">infrastructure</code>. Минимизируется кросс-зависимость между фичами, команды работают автономно.</p><aside class="prompt" data-type="tip" data-title="" id="bfcoha_55"><p>Хорошо сочетается с <span class="tooltip" id="bfcoha_60" title="Часть доменной модели с собственным языком и инвариантами, отделённая от соседних контекстов">ограниченными контекстами</span> из DDD.</p></aside></section><section class="chapter"><h3 id="bfcoha_42" data-toc="bfcoha_42">Чистая архитектура / Гексагональная архитектура</h3><p id="bfcoha_61">Домен в центре, вокруг &mdash; порты/адаптеры. Инфраструктура подключается &laquo;снаружи&raquo; и подменяема. Это усиливает тестируемость и независимость домена.</p></section></section><section class="chapter"><h2 id="bfcoha_6" data-toc="bfcoha_6">Ключевые архитектурные решения в монолите</h2><ul class="list _bullet" id="bfcoha_62"><li class="list__item" id="bfcoha_63"><p><span id="bfcoha_69"><b>Границы модулей.</b></span> Определяйте инварианты и агрегаты. Что должно меняться транзакционно вместе &mdash; в одном модуле.</p></li><li class="list__item" id="bfcoha_64"><p><span id="bfcoha_70"><b>Политика транзакций.</b></span> Явно описывайте границы <span class="tooltip" id="bfcoha_71" title="Свойство данных сохранять инварианты после любых допустимых операций">ACID-согласованности</span>. Сквозные транзакции через всё приложение &mdash; антипаттерн.</p></li><li class="list__item" id="bfcoha_65"><p><span id="bfcoha_72"><b>Доступ к данным.</b></span> Избегайте &laquo;общей&raquo; БД как интеграционного слоя: модуль не должен читать таблицы другого модуля напрямую.</p></li><li class="list__item" id="bfcoha_66"><p><span id="bfcoha_73"><b>Коммуникация модулей.</b></span> Команды/запросы и внутрипроцессные события лучше прямых импортов. Это снижает сцепление.</p></li><li class="list__item" id="bfcoha_67"><p><span id="bfcoha_74"><b>Наблюдаемость.</b></span> Трейсы на уровень модулей/юзкейсов, метрики по горячим путям, структурированные логи.</p></li><li class="list__item" id="bfcoha_68"><p><span id="bfcoha_75"><b>Эволюция.</b></span> План миграций схемы, фича-флаги, &laquo;двойная запись&raquo; при рефакторинге.</p></li></ul></section><section class="chapter"><h2 id="bfcoha_7" data-toc="bfcoha_7">Использование КОП для разбиения разработки на команды</h2><p id="bfcoha_76"><span id="bfcoha_81"><b>КОП (Компонентно-ориентированное программирование)</b></span> &mdash; дисциплина проектирования, где система строится из независимых <span class="tooltip" id="bfcoha_82" title="Автономная единица поставки и замены с явными контрактами и жизненным циклом">компонентов</span> с чёткими интерфейсами и контрактами. В монолите это обеспечивает командную автономию без разделения на микросервисы.</p><ul class="list _bullet" id="bfcoha_77"><li class="list__item" id="bfcoha_83"><p><span id="bfcoha_88"><b>Компонент → команда.</b></span> Каждому компоненту назначается <span class="tooltip" id="bfcoha_89" title="Команда, владеющая компонентом: отвечает за код, инциденты, качество и эволюцию">компонентная команда</span> (ownership кода, сборки, инцидентов).</p></li><li class="list__item" id="bfcoha_84"><p><span id="bfcoha_90"><b>Контракты вместо общих утилит.</b></span> Публичная поверхность компонента &mdash; фасады/порты; общий &laquo;утилитарный&raquo; слой &mdash; только для кросс-срезов (логирование, авторизация).</p></li><li class="list__item" id="bfcoha_85"><p><span id="bfcoha_91"><b>Изоляция хранилища.</b></span> Таблицы компонента отделены (схема/префикс). Доступ &mdash; только через порт компонента.</p></li><li class="list__item" id="bfcoha_86"><p><span id="bfcoha_92"><b>Внутренние события.</b></span> Компоненты публикуют доменные события (в памяти) и подписываются на них &mdash; без прямых импортов реализаций.</p></li><li class="list__item" id="bfcoha_87"><p><span id="bfcoha_93"><b>Границы изменения.</b></span> Изменение инварианта одного компонента не должно требовать каскада в остальных.</p></li></ul><div class="code-block" data-lang="ts">

export type ChargeResult = { ok: boolean; txId?: string };

export interface PaymentsPort {
    charge(orderId: string, amount: number): Promise&lt;ChargeResult&gt;;
}

export class OrdersService {
    constructor(private readonly payments: PaymentsPort) {
    }

    async place(orderId: string, amount: number) {
        const res = await this.payments.charge(orderId, amount);
        console.log(res.ok); // true
        return res;
    }
}</div><aside class="prompt" data-type="note" data-title="" id="bfcoha_79"><p>КОП уменьшает площадь конфликта при мерджах: команды редко правят чужой код, т.к. взаимодействуют через стабильные контракты.</p></aside><aside class="prompt" data-type="warning" data-title="" id="bfcoha_80"><p>Антипаттерн: &laquo;общий домен&raquo; &mdash; когда один &laquo;бог-слой&raquo; видит все таблицы/модели. Это разрушает автономию и повышает связность.</p></aside></section><section class="chapter"><h2 id="bfcoha_8" data-toc="bfcoha_8">Практики для монолита в продакшне</h2><ul class="list _bullet" id="bfcoha_94"><li class="list__item" id="bfcoha_95"><p><span id="bfcoha_100"><b>Статические правила импорта.</b></span> Линт-правила/арх-линтеры запрещают пересечение модульных границ.</p></li><li class="list__item" id="bfcoha_96"><p><span id="bfcoha_101"><b>Контрактные тесты.</b></span> Тесты проверяют публичные фасады модулей и события, а не приватные детали.</p></li><li class="list__item" id="bfcoha_97"><p><span id="bfcoha_102"><b>Миграции с обратной совместимостью.</b></span> Схема меняется в несколько шагов: расширение &rarr; двойная запись &rarr; переключение &rarr; очистка.</p></li><li class="list__item" id="bfcoha_98"><p><span id="bfcoha_103"><b>Версионирование контрактов.</b></span> Переход через <code class="code" id="bfcoha_104">v1</code>/<code class="code" id="bfcoha_105">v2</code> фасадов, период совместимости.</p></li><li class="list__item" id="bfcoha_99"><p><span id="bfcoha_106"><b>Стратегии развертывания.</b></span> Blue/Green, Canary, быстрый откат. Единый артефакт упрощает управление риском.</p></li></ul></section><section class="chapter"><h2 id="bfcoha_9" data-toc="bfcoha_9">Типичные анти-паттерны и как их избегать</h2><ul class="list _bullet" id="bfcoha_107"><li class="list__item" id="bfcoha_109"><p><span id="bfcoha_113"><b>Big Ball of Mud.</b></span> Лечится модульными границами, контрактами и архитектурным линкующим контролем.</p></li><li class="list__item" id="bfcoha_110"><p><span id="bfcoha_114"><b>Общая БД как интеграционный слой.</b></span> Вместо прямого чтения чужих таблиц &mdash; порт/события.</p></li><li class="list__item" id="bfcoha_111"><p><span id="bfcoha_115"><b>God Object / God Service.</b></span> Делите по инвариантам и агрегатам, а не по слоям контроллер/сервис/репозиторий механически.</p></li><li class="list__item" id="bfcoha_112"><p><span id="bfcoha_116"><b>Сквозные транзакции.</b></span> Явно обозначайте границы. Межмодульные операции &mdash; через &laquo;сага&raquo;-подобные процессы внутри одного процесса.</p></li></ul><aside class="prompt" data-type="warning" data-title="" id="bfcoha_108"><p>Если модуль А импортирует приватные типы модуля Б &mdash; вы потеряли независимость релизов и тестируемость. Срочно переведите зависимость на публичный порт.</p></aside></section><section class="chapter"><h2 id="bfcoha_10" data-toc="bfcoha_10">Масштабирование и эволюция монолита</h2><ul class="list _bullet" id="bfcoha_117"><li class="list__item" id="bfcoha_119"><p><span id="bfcoha_122"><b>Scale-up &amp; горизонтальное масштабирование процесса.</b></span> Реплики приложения за балансировщиком, sticky-sessions при необходимости.</p></li><li class="list__item" id="bfcoha_120"><p><span id="bfcoha_123"><b>Разделение нагрузки.</b></span> Вынесение фоновых работ в очереди/воркеры, read-replicas для отчётности.</p></li><li class="list__item" id="bfcoha_121"><p><span id="bfcoha_124"><b>Стратегия &laquo;Strangler Fig&raquo;.</b></span> Когда появится потребность &mdash; выносите самый горячий компонент в отдельный сервис, не ломая контракты.</p></li></ul><aside class="prompt" data-type="tip" data-title="" id="bfcoha_118"><p>Первые месяцы/релизы почти всегда выгоднее делать как <span class="tooltip" id="bfcoha_125" title="Монолит, организованный как набор изолированных модулей с публичными контрактами и скрытыми внутренностями">модульный монолит</span>. Микросервисы &mdash; инструмент оптимизации под конкретные бутылочные горлышки.</p></aside></section><section class="chapter"><h2 id="bfcoha_11" data-toc="bfcoha_11">Мини-шаблоны структуры репозитория (пример)</h2><div class="code-block" data-lang="bash">.
├─ app/
│  ├─ modules/
│  │  ├─ orders/
│  │  │  ├─ application/
│  │  │  ├─ domain/
│  │  │  └─ infrastructure/
│  │  └─ payments/
│  │     ├─ application/
│  │     ├─ domain/
│  │     └─ infrastructure/
│  ├─ shared/        # только кросс-срез: логирование, auth, tracing
│  └─ platform/      # запуск, конфиг, DI-контейнер
└─ tests/</div><aside class="prompt" data-type="note" data-title="" id="bfcoha_127"><p>&laquo;shared&raquo; не должен хранить бизнес-логику. Это частая причина &laquo;утечки&raquo; зависимостей.</p></aside></section><section class="chapter"><h2 id="bfcoha_12" data-toc="bfcoha_12">Пример инварианта на уровне БД</h2><p id="bfcoha_128">Даже в монолите <span class="tooltip" id="bfcoha_130" title="Правило, которое должно быть истинным для доменных данных всегда">инварианты</span> лучше дублировать: в домене и в БД.</p><div class="code-block" data-lang="sql">ALTER TABLE orders
                ADD CONSTRAINT chk_total_non_negative
                    CHECK (total_amount &gt;= 0);</div></section><section class="chapter"><h2 id="bfcoha_13" data-toc="bfcoha_13">Чек-лист готовности</h2><ul class="list _bullet" id="bfcoha_131"><li class="list__item" id="bfcoha_132"><p>Определены публичные фасады модулей; приватное не импортируется снаружи.</p></li><li class="list__item" id="bfcoha_133"><p>Покрыты контрактные тесты и тесты инвариантов.</p></li><li class="list__item" id="bfcoha_134"><p>Наблюдаемость: метрики по модулю и ключевым юзкейсам, трассировка.</p></li><li class="list__item" id="bfcoha_135"><p>Схема БД разделена по модулям (схемы/префиксы), миграции обратносуместимы.</p></li><li class="list__item" id="bfcoha_136"><p>Релизная стратегия документирована, откат проверен.</p></li></ul></section><div class="last-modified">25 сентября 2025</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="domainmodel.html" class="navigation-links__prev">Доменная модель</a><a href="microarch.html" class="navigation-links__next">Микросервисная архитектура</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.js"></script></body></html>