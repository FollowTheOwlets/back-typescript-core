<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#C14424" data-link-color="#C14424"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2025-10-01T18:55:35.1494883"><title>Авторизация и Аутентификация | Backend Typescript</title><script type="application/json" id="virtual-toc-data">[{"id":"z1w28ot_2","level":0,"title":"Зачем это нужно","anchor":"#z1w28ot_2"},{"id":"z1w28ot_3","level":0,"title":"Идентификация, аутентификация и авторизация — в чём различие","anchor":"#z1w28ot_3"},{"id":"z1w28ot_4","level":0,"title":"Факторы аутентификации","anchor":"#z1w28ot_4"},{"id":"z1w28ot_5","level":0,"title":"Сеансы и токены доступа","anchor":"#z1w28ot_5"},{"id":"z1w28ot_6","level":0,"title":"OAuth2: делегирование доступа","anchor":"#z1w28ot_6"},{"id":"z1w28ot_7","level":0,"title":"OpenID Connect: слой идентичности поверх OAuth2","anchor":"#z1w28ot_7"},{"id":"z1w28ot_8","level":0,"title":"JWT: формат компактных токенов","anchor":"#z1w28ot_8"},{"id":"z1w28ot_9","level":0,"title":"Модели авторизации: роли, атрибуты, политики","anchor":"#z1w28ot_9"},{"id":"z1w28ot_10","level":0,"title":"Жизненный цикл токенов: срок, обновление, отзыв","anchor":"#z1w28ot_10"},{"id":"z1w28ot_11","level":0,"title":"SSO и федерация","anchor":"#z1w28ot_11"},{"id":"z1w28ot_12","level":0,"title":"Хранение и защита секретов","anchor":"#z1w28ot_12"},{"id":"z1w28ot_13","level":0,"title":"Типичные угрозы и защиты","anchor":"#z1w28ot_13"},{"id":"z1w28ot_14","level":0,"title":"Принципы проектирования политики доступа","anchor":"#z1w28ot_14"},{"id":"z1w28ot_15","level":0,"title":"Как соединяются понятия темы","anchor":"#z1w28ot_15"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.css" rel="stylesheet"><link rel="icon" type="image/png" sizes="16x16" href="images/logo.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Авторизация и Аутентификация | Backend Typescript"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Backend Typescript Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation//1.0.0/auth.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Авторизация и Аутентификация | Backend Typescript"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation//1.0.0/auth.html#webpage",
    "url": "writerside-documentation//1.0.0/auth.html",
    "name": "Авторизация и Аутентификация | Backend Typescript",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "Backend Typescript Help"
}</script><!-- End Schema.org --></head><body data-id="Auth" data-main-title="Авторизация и Аутентификация" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="_Backend.topic|Backend"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Backend Typescript 1.0.0 Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Auth" id="Auth.topic">Авторизация и Аутентификация</h1><section class="chapter"><h2 id="z1w28ot_2" data-toc="z1w28ot_2">Зачем это нужно</h2><p id="z1w28ot_16">В любой информационной системе важно понимать, <span id="z1w28ot_17"><b>кто</b></span> к ней обращается и <span id="z1w28ot_18"><b>что</b></span> этому участнику позволено делать. Эти две задачи разделяются на процессы <span class="tooltip" id="z1w28ot_19" title="Подтверждение личности субъекта: проверка того, что он и есть тот, за кого себя выдаёт">аутентификации</span> (подтверждение личности) и <span class="tooltip" id="z1w28ot_20" title="Принятие решения о предоставлении или запрете доступа к конкретным действиям и ресурсам">авторизации</span> (проверка прав доступа). Разделение обязанностей снижает риски, упрощает поддержку и повышение уровня безопасности.</p></section><section class="chapter"><h2 id="z1w28ot_3" data-toc="z1w28ot_3">Идентификация, аутентификация и авторизация &mdash; в чём различие</h2><ul class="list _bullet" id="z1w28ot_21"><li class="list__item" id="z1w28ot_23"><p><span id="z1w28ot_26"><b><span class="tooltip" id="z1w28ot_27" title="Первичное объявление своей личности без доказательства (заявление «кто я»)">Идентификация</span></b></span> &mdash; объявление своей личности: «Я &mdash; пользователь X».</p></li><li class="list__item" id="z1w28ot_24"><p><span id="z1w28ot_28"><b><span class="tooltip" id="z1w28ot_29" title="Подтверждение личности субъекта: проверка того, что он и есть тот, за кого себя выдаёт">Аутентификация</span></b></span> &mdash; доказательство, что вы и есть X (пароль, одноразовый код, ключ и т.п.).</p></li><li class="list__item" id="z1w28ot_25"><p><span id="z1w28ot_30"><b><span class="tooltip" id="z1w28ot_31" title="Принятие решения о предоставлении или запрете доступа к конкретным действиям и ресурсам">Авторизация</span></b></span> &mdash; определение, какие действия вам разрешены (чтение, запись, администрирование и т.п.).</p></li></ul><aside class="prompt" data-type="note" data-title="" id="z1w28ot_22"><p>Думайте об этом как о трёх шагах: назвать себя → доказать → получить разрешение.</p></aside></section><section class="chapter"><h2 id="z1w28ot_4" data-toc="z1w28ot_4">Факторы аутентификации</h2><p id="z1w28ot_32">Надёжность подтверждения личности повышается комбинацией разных факторов:</p><ul class="list _bullet" id="z1w28ot_33"><li class="list__item" id="z1w28ot_35"><p><span id="z1w28ot_39"><b>Знание</b></span> &mdash; то, что знает пользователь (пароль, PIN).</p></li><li class="list__item" id="z1w28ot_36"><p><span id="z1w28ot_40"><b>Обладание</b></span> &mdash; то, что у пользователя есть (телефон, аппаратный токен).</p></li><li class="list__item" id="z1w28ot_37"><p><span id="z1w28ot_41"><b>Присущая характеристика</b></span> &mdash; биометрия (отпечаток, лицо).</p></li><li class="list__item" id="z1w28ot_38"><p><span id="z1w28ot_42"><b>Контекст</b></span> &mdash; место, время, устройство, поведенческие признаки.</p></li></ul><aside class="prompt" data-type="tip" data-title="" id="z1w28ot_34"><p>Комбинация факторов называется <span class="tooltip" id="z1w28ot_43" title="Многофакторная аутентификация: использование двух и более факторов (знание, обладание, биометрия, контекст)">многофакторной аутентификацией</span>; она существенно усложняет жизнь злоумышленнику.</p></aside></section><section class="chapter"><h2 id="z1w28ot_5" data-toc="z1w28ot_5">Сеансы и токены доступа</h2><p id="z1w28ot_44">После успешной аутентификации система должна «помнить» пользователя. Для этого используют <span class="tooltip" id="z1w28ot_47" title="Состояние, связывающее пользователя и сервер после входа (обычно поддерживается куками)">сеанс</span> (session) или <span class="tooltip" id="z1w28ot_48" title="Маркер, предоставляющий ограниченные права доступа к ресурсам в течение заданного времени">токен доступа</span>.</p><ul class="list _bullet" id="z1w28ot_45"><li class="list__item" id="z1w28ot_49"><p><span id="z1w28ot_51"><b>Сеансы</b></span> чаще всего поддерживаются куками и хранят состояние на стороне сервера.</p></li><li class="list__item" id="z1w28ot_50"><p><span id="z1w28ot_52"><b>Токены</b></span> обычно статeless: сервер проверяет их валидность без хранения состояния.</p></li></ul><aside class="prompt" data-type="note" data-title="" id="z1w28ot_46"><p>Выбор зависит от архитектуры: монолитам часто удобны сеансы, распределённым системам &mdash; токены.</p></aside></section><section class="chapter"><h2 id="z1w28ot_6" data-toc="z1w28ot_6">OAuth2: делегирование доступа</h2><p id="z1w28ot_53"><span class="tooltip" id="z1w28ot_56" title="Стандарт делегирования доступа, позволяющий приложению запрашивать доступ к ресурсам от имени пользователя">OAuth2</span> решает задачу безопасного <span id="z1w28ot_57"><b>делегирования</b></span> доступа к ресурсам. Пользователь (Владелец ресурса) разрешает Приложению-клиенту выполнять ограничённые действия на Сервере ресурсов без передачи пароля. Разрешения выражаются через <span class="tooltip" id="z1w28ot_58" title="Область/объём разрешённых действий, запрошенных клиентом и выданных авторизационным сервером">scopes</span> (области доступа).</p><ul class="list _bullet" id="z1w28ot_54"><li class="list__item" id="z1w28ot_59"><p><span id="z1w28ot_62"><b>Авторизационный сервер</b></span> выдаёт токены.</p></li><li class="list__item" id="z1w28ot_60"><p><span id="z1w28ot_63"><b>Сервер ресурсов</b></span> защищает данные и проверяет токены.</p></li><li class="list__item" id="z1w28ot_61"><p><span id="z1w28ot_64"><b>Клиент</b></span> запрашивает доступ к данным от имени пользователя.</p></li></ul><aside class="prompt" data-type="warning" data-title="" id="z1w28ot_55"><p>OAuth2 сам по себе не определяет, <span id="z1w28ot_65"><b>кто</b></span> пользователь &mdash; только выдаёт доступ по согласию. Для информации о личности обычно используют <span class="tooltip" id="z1w28ot_66" title="Расширение OAuth2 для идентификации пользователя посредством ID Token и стандартных протокольных точек">OpenID Connect</span>.</p></aside></section><section class="chapter"><h2 id="z1w28ot_7" data-toc="z1w28ot_7">OpenID Connect: слой идентичности поверх OAuth2</h2><p id="z1w28ot_67"><span class="tooltip" id="z1w28ot_69" title="Расширение OAuth2 для идентификации пользователя посредством ID Token и стандартных протокольных точек">OIDC</span> добавляет к OAuth2 <span id="z1w28ot_70"><b>идентификацию</b></span> пользователя. Он вводит <span class="tooltip" id="z1w28ot_71" title="Токен OIDC с утверждениями о пользователе (кто вошёл, когда выдано и т.п.)">ID Token</span> c набором <span class="tooltip" id="z1w28ot_72" title="Утверждение внутри токена (идентификатор, аудитория, срок действия, роли и т.п.)">claims</span> (утверждений о пользователе: идентификатор, email, время выпуска и т.п.). Благодаря этому клиент может знать, кто вошёл, и привязать сеанс к конкретной личности.</p><aside class="prompt" data-type="tip" data-title="" id="z1w28ot_68"><p>OIDC стандартизует «user info endpoint», форматы токенов и механизмы обнаружения конфигурации провайдера, упрощая интеграции и SSO.</p></aside></section><section class="chapter"><h2 id="z1w28ot_8" data-toc="z1w28ot_8">JWT: формат компактных токенов</h2><p id="z1w28ot_73"><span class="tooltip" id="z1w28ot_76" title="JSON Web Token — компактный формат переноса утверждений с подписью/проверкой целостности">JSON Web Token</span> &mdash; это компактный, URL-безопасный формат для переноса утверждений. Он обычно состоит из <span id="z1w28ot_77"><b>заголовка</b></span>, <span id="z1w28ot_78"><b>полезной нагрузки</b></span> (claims) и <span id="z1w28ot_79"><b>подписи</b></span> или <span id="z1w28ot_80"><b>MAC</b></span>. Проверив подпись и целостность, система принимает решение об авторизации.</p><ul class="list _bullet" id="z1w28ot_74"><li class="list__item" id="z1w28ot_81"><p><span id="z1w28ot_84"><b>Подпись</b></span>: асимметричная (RS/EC) или симметричная (HMAC).</p></li><li class="list__item" id="z1w28ot_82"><p><span id="z1w28ot_85"><b>Стандартные claims</b></span>: <code class="code" id="z1w28ot_86">iss</code>, <code class="code" id="z1w28ot_87">sub</code>, <code class="code" id="z1w28ot_88">aud</code>, <code class="code" id="z1w28ot_89">exp</code>, <code class="code" id="z1w28ot_90">iat</code>, <code class="code" id="z1w28ot_91">nbf</code>.</p></li><li class="list__item" id="z1w28ot_83"><p><span id="z1w28ot_92"><b>Пользовательские claims</b></span>: роли, разрешения, контекстные сведения.</p></li></ul><aside class="prompt" data-type="warning" data-title="" id="z1w28ot_75"><p>JWT неизменяем, но <span id="z1w28ot_93"><b>не шифрован</b></span> по умолчанию. Не кладите в него чувствительные данные. Для конфиденциальности применяют JWE (шифрование), для целостности &mdash; JWS (подпись).</p></aside></section><section class="chapter"><h2 id="z1w28ot_9" data-toc="z1w28ot_9">Модели авторизации: роли, атрибуты, политики</h2><ul class="list _bullet" id="z1w28ot_94"><li class="list__item" id="z1w28ot_96"><p><span id="z1w28ot_99"><b><span class="tooltip" id="z1w28ot_100" title="Ролевая модель авторизации: доступ определяется ролями">RBAC</span></b></span> &mdash; доступ по ролям (роль агрегирует разрешения).</p></li><li class="list__item" id="z1w28ot_97"><p><span id="z1w28ot_101"><b><span class="tooltip" id="z1w28ot_102" title="Атрибутивная модель авторизации: доступ по правилам и атрибутам субъекта/объекта/контекста">ABAC</span></b></span> &mdash; доступ по атрибутам субъекта, объекта и контекста.</p></li><li class="list__item" id="z1w28ot_98"><p><span id="z1w28ot_103"><b><span class="tooltip" id="z1w28ot_104" title="Policy-Based Access Control — управление доступом на основе формализованных политик">PBAC/Policy-based</span></b></span> &mdash; доступ по политикам (правила, написанные на DSL/языке политик).</p></li></ul><aside class="prompt" data-type="note" data-title="" id="z1w28ot_95"><p>Часто применяют гибрид: роли для грубого разграничения, атрибуты и политики &mdash; для точной настройки.</p></aside></section><section class="chapter"><h2 id="z1w28ot_10" data-toc="z1w28ot_10">Жизненный цикл токенов: срок, обновление, отзыв</h2><p id="z1w28ot_105">Безопасная работа с токенами требует управления жизненным циклом:</p><ul class="list _bullet" id="z1w28ot_106"><li class="list__item" id="z1w28ot_108"><p><span id="z1w28ot_112"><b><span class="tooltip" id="z1w28ot_113" title="Период, в течение которого токен считается действительным; после истечения требуется обновление">TTL</span></b></span> &mdash; короткие сроки уменьшают окно атаки.</p></li><li class="list__item" id="z1w28ot_109"><p><span id="z1w28ot_114"><b><span class="tooltip" id="z1w28ot_115" title="Токен для обновления токена доступа без повторной аутентификации пользователя">Refresh token</span></b></span> &mdash; отдельный долгоживущий токен для обновления доступа.</p></li><li class="list__item" id="z1w28ot_110"><p><span id="z1w28ot_116"><b>Отзыв</b></span> &mdash; механизмы немедленной блокировки (чёрные списки, ротация ключей, версии сессий).</p></li><li class="list__item" id="z1w28ot_111"><p><span id="z1w28ot_117"><b>Ротация ключей</b></span> &mdash; периодическая смена криптоключей и публикация их через <span class="tooltip" id="z1w28ot_118" title="JSON Web Key Set — формат публикации открытых ключей для проверки подписей токенов">JWKS</span>.</p></li></ul><aside class="prompt" data-type="tip" data-title="" id="z1w28ot_107"><p>Минимизируйте объём прав и срок действия каждого токена по принципу наименьших привилегий.</p></aside></section><section class="chapter"><h2 id="z1w28ot_11" data-toc="z1w28ot_11">SSO и федерация</h2><p id="z1w28ot_119">Единый вход позволяет пользователю аутентифицироваться один раз и получать доступ к нескольким приложениям. <span class="tooltip" id="z1w28ot_121" title="Доверительная связь между доменами, позволяющая использовать единую учётную запись в разных системах">Федерация</span> связывает доверенные домены: один выступает как поставщик идентичности, другие &mdash; как потребители.</p><aside class="prompt" data-type="note" data-title="" id="z1w28ot_120"><p>SSO снижает количество паролей и улучшает UX, но повышает требования к защите центральной точки входа.</p></aside></section><section class="chapter"><h2 id="z1w28ot_12" data-toc="z1w28ot_12">Хранение и защита секретов</h2><p id="z1w28ot_122">Если система управляет паролями или ключами, необходимо:</p><ul class="list _bullet" id="z1w28ot_123"><li class="list__item" id="z1w28ot_125"><p>Хэшировать пароли адаптивными алгоритмами (<span class="tooltip" id="z1w28ot_128" title="Адаптивный алгоритм хэширования паролей, устойчивый к атакам перебора на современных платформах">Argon2</span>, <span class="tooltip" id="z1w28ot_129" title="Функция derivation-ключей, применяемая для замедления перебора паролей">PBKDF2</span>, <span class="tooltip" id="z1w28ot_130" title="Адаптивная функция хэширования паролей, усложняющая массовый перебор">bcrypt</span>), использовать соль и перец (secret pepper).</p></li><li class="list__item" id="z1w28ot_126"><p>Изолировать секреты в защищённом хранилище (менеджер секретов, HSM).</p></li><li class="list__item" id="z1w28ot_127"><p>Обновлять криптополитику при изменениях угроз и стандартов.</p></li></ul><aside class="prompt" data-type="warning" data-title="" id="z1w28ot_124"><p>Никогда не храните пароли в открытом виде и не передавайте их без <span class="tooltip" id="z1w28ot_131" title="Криптографический протокол для защищённой передачи данных по сети">TLS</span>.</p></aside></section><section class="chapter"><h2 id="z1w28ot_13" data-toc="z1w28ot_13">Типичные угрозы и защиты</h2><ul class="list _bullet" id="z1w28ot_132"><li class="list__item" id="z1w28ot_134"><p><span id="z1w28ot_139"><b><span class="tooltip" id="z1w28ot_140" title="Социальная атака, провоцирующая пользователя выдать секреты под видом доверенного источника">Фишинг</span></b></span> &mdash; защищайтесь MFA, проверкой доменов, обучением пользователей.</p></li><li class="list__item" id="z1w28ot_135"><p><span id="z1w28ot_141"><b>Перехват токенов</b></span> &mdash; используйте HTTPS, ограничивайте время жизни, привязывайте к аудитории/устройству, применяйте безопасные куки.</p></li><li class="list__item" id="z1w28ot_136"><p><span id="z1w28ot_142"><b>Реплей-атаки</b></span> &mdash; nonce, одноразовые коды, короткий TTL.</p></li><li class="list__item" id="z1w28ot_137"><p><span id="z1w28ot_143"><b>Подбор паролей</b></span> &mdash; замедляющие хэши, капчи, ограничение попыток, обнаружение аномалий.</p></li><li class="list__item" id="z1w28ot_138"><p><span id="z1w28ot_144"><b>Утечка ключей</b></span> &mdash; ротация, сегрегация, мониторинг, отозвать токены, перевыпустить ключи.</p></li></ul><aside class="prompt" data-type="note" data-title="" id="z1w28ot_133"><p>Логи аутентификации и авторизации должны быть централизованы, защищены и анализироваться для обнаружения инцидентов.</p></aside></section><section class="chapter"><h2 id="z1w28ot_14" data-toc="z1w28ot_14">Принципы проектирования политики доступа</h2><ul class="list _bullet" id="z1w28ot_145"><li class="list__item" id="z1w28ot_146"><p><span id="z1w28ot_151"><b>Минимально необходимые привилегии</b></span> &mdash; выдавайте только те права, что нужны для задачи.</p></li><li class="list__item" id="z1w28ot_147"><p><span id="z1w28ot_152"><b>Подотчётность</b></span> &mdash; каждое действие должно быть атрибутировано субъекту.</p></li><li class="list__item" id="z1w28ot_148"><p><span id="z1w28ot_153"><b>Разделение обязанностей</b></span> &mdash; критичные операции требуют участия нескольких ролей.</p></li><li class="list__item" id="z1w28ot_149"><p><span id="z1w28ot_154"><b>Прозрачность</b></span> &mdash; политики понятны и проверяемы.</p></li><li class="list__item" id="z1w28ot_150"><p><span id="z1w28ot_155"><b>Адаптивность</b></span> &mdash; учитывайте риск-контекст (время, гео, устройство).</p></li></ul></section><section class="chapter"><h2 id="z1w28ot_15" data-toc="z1w28ot_15">Как соединяются понятия темы</h2><p id="z1w28ot_156">На практике цепочка выглядит так: пользователь проходит <span class="tooltip" id="z1w28ot_157" title="Подтверждение личности субъекта: проверка того, что он и есть тот, за кого себя выдаёт">аутентификацию</span> у <span class="tooltip" id="z1w28ot_158" title="Система, выполняющая аутентификацию и выдающую токены/утверждения о пользователе">поставщика идентичности</span> (часто через OIDC), получает <span class="tooltip" id="z1w28ot_159" title="Токен OIDC с утверждениями о пользователе (кто вошёл, когда выдано и т.п.)">ID Token</span> и <span class="tooltip" id="z1w28ot_160" title="Токен, который предоставляет клиенту доступ к защищённым ресурсам (обычно предъявляется серверу ресурсов)">Access Token</span>. Клиент предъявляет <span class="tooltip" id="z1w28ot_161" title="Токен, который предоставляет клиенту доступ к защищённым ресурсам (обычно предъявляется серверу ресурсов)">токен доступа</span> серверу ресурсов. Сервер проверяет подпись, срок действия и область (<span class="tooltip" id="z1w28ot_162" title="Область/объём разрешённых действий, запрошенных клиентом и выданных авторизационным сервером">scope</span>) и принимает решение об <span class="tooltip" id="z1w28ot_163" title="Принятие решения о предоставлении или запрете доступа к конкретным действиям и ресурсам">авторизации</span> согласно ролям, атрибутам и политикам.</p></section><div class="last-modified">26 сентября 2025</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="altprotocols.html" class="navigation-links__prev">Альтернативные протоколы</a><a href="api.html" class="navigation-links__next">API-контракты</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.js"></script></body></html>